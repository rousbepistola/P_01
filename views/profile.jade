doctype html
html(lang='en')
  head
    meta(charset='UTF-8')
    meta(name='viewport', content='width=device-width, initial-scale=1.0, shrink-to-fit=no')
    title Localetti Dashboard
    // BOOTSTRAP
    link(rel='stylesheet', href='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css', integrity='sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh', crossorigin='anonymous')
    script(async='', src='https://code.jquery.com/jquery-3.4.1.slim.min.js', integrity='sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n', crossorigin='anonymous')
    script(async='', src='https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js', integrity='sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo', crossorigin='anonymous')
    script(async='', src='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js', integrity='sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6', crossorigin='anonymous')
    // FONTAWESOME
    script(src='https://kit.fontawesome.com/3d3ae9b37d.js', crossorigin='anonymous')
    // GOOGLE FONT
    link(href='https://fonts.googleapis.com/css?family=Montserrat&display=swap', rel='stylesheet')
    // STYLESHEET
    link(rel='stylesheet', href='/stylesheets/dashboard.css')
  body
    nav.navbar.navbar-expand-md.navbar-light
      button.navbar-toggler.ml-auto.mb-2.bg-light(type='button', data-toggle='collapse', data-target='#myNavbar')
        span.navbar-toggler-icon
      #myNavbar.collapse.navbar-collapse
        .container-fluid
          .row
            // sidebar
            .col-lg-3.col-xl-2.col-md-4.sidebar.fixed-top
              a.navbar-brand.text-white.d-block.mx-auto.text-center.py-3.mb-4.bottom-border(href='') Localetti
              .bottom-border.pb-3
                //- img.rounded-circle.mr-3(src='https://images.pexels.com/photos/614810/pexels-photo-614810.jpeg?auto=compress&cs=tinysrgb&h=750&w=1260', alt='Image on Profile dashboard', width='50', height='50')
                h3.text-white #{name}
                a.text-white(href='#') #{mail}
              ul.navbar-nav.flex-column.mt-4
                li.nav-item
                  a.nav-link.text-white.p-3.mb-2.current(href='#')
                    i.fa.fa-home.text-light.fa-lg.mr-2
                    | Dashboard
                li.nav-item
                  a.nav-link.text-white.p-3.mb-2.sidebar-link(href='#')
                    i.fa.fa-user.text-light.fa-lg.mr-2
                    | Profile Settings (WIP)
                li.nav-item
                  a.nav-link.text-white.p-3.mb-2.sidebar-link(href='#')
                    i.fa.fa-envelope.text-light.fa-lg.mr-2
                    | Inbox (WIP)
            // end of sidebar
            // topNav
            .col-lg-9.col-xl-10.col-md-8.ml-auto.bg-dark.fixed-top.py-2.top-navbar(style='z-index:10;')
              .row.align-item-center
                .col-md-4
                  h4.text-light.text-uppercase.mt-1 #{name} - Dashboard
                .col-md-5
                  form(action='#' id="location-form")
                    .input-group
                      input.form-control.search-input.text-white(type='text',id="location-input" placeholder='Search neighborhood . . .')
                      button.btn.btn-info(type='submit')
                        i.fas.fa-search.text-danger.search-button
                .col-md-3
                  ul.navbar-nav
                    ul.nav-item.ml-md-auto.icon-parent
                      a.nav-link.icon-bullet.text-white(href='logout')
                        i.fas.fa-sign-out-alt.text-muted.fa-lg
                        | Logout


    section
      .container-fluid
        .row
          .col-lg-9.col-md-8.ml-auto
            .row.pt-5.mt-3.mb-5
              .col-lg-1
              .col-sm-12.col-md-12.col-lg-10.pd-2
                .card
                  .card-body
                    i.fas.fa-map.fa-2x.text-info.mb-3  Location Information
                    #geometry
                    .text-left.text-secondary
                      p#formatted-address
                      p#address-components
              .col-lg-1

          .col-lg-9.col-md-8.ml-auto
            .row.pt-5.mt-3.mb-5
              .col-lg-1
              .col-sm-12.col-md-12.col-lg-10.pd-2
                .card
                  .card-body
                    .text-left.text-secondary
<<<<<<< Updated upstream
                      h4.text-success Air Quality In the area (Not Live yet)
=======
                      button.btn.btn-info.mb-4(onclick='airQualityBreezo()') Get Air Quality from BreezoMeter
                      h4.text-success Air Quality Summary
                      .col-md-12#airQualityOutput2
                      //- .progress
                      //-   .progress-bar.bg-success(role='progressbar', style='width: 75%', aria-valuenow='25', aria-valuemin='0', aria-valuemax='100')
              .col-lg-1

          .col-lg-9.col-md-8.ml-auto
            .row.pt-5.mt-3.mb-5
              .col-lg-1
              .col-sm-12.col-md-12.col-lg-10.pd-2
                .card
                  .card-body
                    .text-left.text-secondary
                      button.btn.btn-warning.mb-4(onclick='crimeNow()') Get Crime Rate
                      h4.text-success Crime Rate In the area (Better Data presentation WIP)
                      p
                        strong Crimes reported on a approx 3km radius
                      h6#crimeRateOutput
                        strong OVERALL QUALITY
                      //- .progress
                      //-   .progress-bar.bg-success(role='progressbar', style='width: 75%', aria-valuenow='25', aria-valuemin='0', aria-valuemax='100')
              .col-lg-1

          .col-lg-9.col-md-8.ml-auto
            .row.pt-5.mt-3.mb-5
              .col-lg-1
              .col-sm-12.col-md-12.col-lg-10.pd-2
                .card
                  .card-body
                    .text-left.text-secondary
                      button.btn.btn-success(onclick='airQuality()') Get Air Quality
                      h4.text-success Air Quality In the area (Better Data presentation WIP)
                      p
                        strong BRIEF EXPLANATION ON A TOOLTIP?
                      h6#airQualityOutput
                        strong OVERALL QUALITY
                      //- .progress
                      //-   .progress-bar.bg-success(role='progressbar', style='width: 75%', aria-valuenow='25', aria-valuemin='0', aria-valuemax='100')
              .col-lg-1

          .col-lg-9.col-md-8.ml-auto
            .row.pt-5.mt-3.mb-5
              .col-lg-1
              .col-sm-12.col-md-12.col-lg-10.pd-2
                .card
                  .card-body
                    .text-left.text-secondary
                      button.btn.btn-success(onclick='airQuality()') Get Air Quality
                      h4.text-success Air Quality In the area (Better Data presentation WIP)
>>>>>>> Stashed changes
                      p
                        strong BRIEF EXPLANATION ON A TOOLTIP?
                      h6  AQI:29
                      h6 aqiInfo:"{"category": "Good", "pollutant": "PM2.5", "concentration": 6}"
                      h6 updatedAt:"2020-03-25T16:05:28.000Z"
                      h6 countryCode:"CA"
                      h6 placeName:"Downtown Toronto (Rosedale)"
                      h6 postalCode:"M4W"
                      h6 state:"Ontario"
                      h6 city:"Ontario ON"
                      h6 division:"Toronto"
                      h6 lat:43.6827
                      h6 lng:-79.373
                      h6
                        strong OVERALL QUALITY
                      .progress
                        .progress-bar.bg-success(role='progressbar', style='width: 75%', aria-valuenow='25', aria-valuemin='0', aria-valuemax='100')
              .col-lg-1

<<<<<<< Updated upstream
          .col-lg-9.col-md-8.ml-auto
            .row.pt-5.mt-3.mb-5
              .col-lg-1
              .col-sm-12.col-md-12.col-lg-10.pd-2
                .card
                  .card-body
                    .text-left.text-secondary
                      h4.text-success Crime Rate and Numbers (Not Live yet)
                      p
                        strong BRIEF EXPLANATION ON A TOOLTIP?
                      h6 updatedAt:"2020-03-25T16:05:28.000Z"
                      h6 countryCode:"CA"
                      h6 postalCode:"M4W"
                      h6 state:"Ontario"
                      h6 city:"Ontario ON"
                      h6 division:"Toronto"
                      h6 lat:43.6827
                      h6 lng:-79.373
                      h6
                        strong OVERALL SAFETY
                      .progress
                        .progress-bar.bg-warning(role='progressbar', style='width: 33%', aria-valuenow='25', aria-valuemin='0', aria-valuemax='100')
              .col-lg-1
      script(src='https://unpkg.com/axios/dist/axios.min.js')
=======

    script(src='https://unpkg.com/axios/dist/axios.min.js')
>>>>>>> Stashed changes
    script.
      // geocode();
      // GET LOCATION FORM
      var locationForm = document.getElementById('location-form');
      // listen for submit
      locationForm.addEventListener('submit', geocode)
      function geocode(e){
      // prevent actual submit
      e.preventDefault();
      let location = document.getElementById('location-input').value;

      
      // let location = '70 bradstone sq scarborough';
      axios.get('https://maps.googleapis.com/maps/api/geocode/json', {
      params:{
      address: location,
      key: 'AIzaSyCFpf4F_1DzzQmZrf3xsNggEibIQixO0k8'
      }
      })
      .then(function(response){
        let airQualityOutput2 =  document.getElementById('airQualityOutput2');
        airQualityOutput2.innerHTML = "";
      // log full response
      console.log(response);
      // formatted address
      let formattedAddress = response.data.results[0].formatted_address;
      let formattedAddressOutput = `
      <ul>
      <li>${formattedAddress}</li>
      </ul>
      `;
      // ADDRESS COMPONENTS
      let addressComponents = response.data.results[0].address_components;
      let addressComponentsOutput = '<ul>';
      for(let i = 0; i < addressComponents.length; i++){
      addressComponentsOutput += `
      <li>${addressComponents[i].types[0]} :  ${addressComponents[i].long_name}</li>
      `;
      }
      addressComponentsOutput += '</ul>'
      // Geometry
      let lat = response.data.results[0].geometry.location.lat;
      let lng = response.data.results[0].geometry.location.lng;
      let geometryOutput = `
      <ul>
      <li><strong>Latitude: </strong>${lat}</li>
      <li><strong>Longitude: </strong>${lng}</li>
      </ul>
      `;
      // OUTPUT TO APP
      document.getElementById('formatted-address').innerHTML = formattedAddressOutput;
      document.getElementById('address-components').innerHTML = addressComponentsOutput;
      document.getElementById('geometry').innerHTML = geometryOutput;
      })
      .catch(function(error){
      console.log(error);
      })
      }
<<<<<<< Updated upstream
            
=======


      //- CODE FOR BREEZOMETER AIR QUALITY//
      function airQualityBreezo(){

        let airLat = document.getElementById('latResult').innerHTML;
        let airLng = document.getElementById('lngResult').innerHTML;
        let airQualityOutput2 =  document.getElementById('airQualityOutput2');
        airQualityOutput2.innerHTML = "Loading Information";
        let breezoKey = '453ca008418a45f889a118dcb9cac1da';

        axios({
            "method":"GET",
            "url":`https://api.breezometer.com/air-quality/v2/current-conditions?lat=${airLat}&lon=${airLng}&key=${breezoKey}&features=breezometer_aqi,local_aqi,health_recommendations,sources_and_effects,pollutants_concentrations,pollutants_aqi_information`,
            })
            .then((response)=>{
              console.log(response);
              let pollutant= response.data.data.pollutants; 
              let category;
              category = response.data.data.indexes.baqi.category;
              airQualityOutput2.innerHTML = `

              <div class="container-fluid">
                  <div class="row">
                    <div class="col-lg-9 col-md-6 col-sm-12 pt-3 card mb-3">
                        <h3 class="text-center lead">Air Quality</h4>
                        <h6 class="text-center">${category}</h6>
                        <hr>
                        <h3 class="text-center lead">Dominant pollutant</h4>
                        <h6 class="text-center">${response.data.data.indexes.baqi.dominant_pollutant}</h6>
                    </div>
                
                  <div class="col-lg-3 col-md-6 col-sm-12" style="z-index:1">
                        <h5>Recommendations</h5>
                        <div class="tooltip"><i class="fas fa-info-circle"></i> General Recommendation <span class="tooltiptext">${response.data.data.health_recommendations.general_population}</span></div>
                        <div class="tooltip"><i class="fas fa-info-circle"></i> For the elderly <span class="tooltiptext"> ${response.data.data.health_recommendations.elderly}</span></div>
                        <div class="tooltip"><i class="fas fa-info-circle"></i> For people with lung disease <span class="tooltiptext">${response.data.data.health_recommendations.lung_diseases}</span></div>
                        <div class="tooltip"><i class="fas fa-info-circle"></i> For people with heart disease <span class="tooltiptext">${response.data.data.health_recommendations.heart_diseases}</span></div>
                        <div class="tooltip"><i class="fas fa-info-circle"></i> For physically active people <span class="tooltiptext">${response.data.data.health_recommendations.active}</span></div>
                        <div class="tooltip"><i class="fas fa-info-circle"></i> For pregnant women  <span class="tooltiptext">${response.data.data.health_recommendations.pregnant_women}</span></div>
                        <div class="tooltip"><i class="fas fa-info-circle"></i> For children  <span class="tooltiptext">${response.data.data.health_recommendations.children}</span></div>
                  </div>  
                  </div>
              </div>

             

              <h4 class="mt-5 text-warning">POLLUTANTS</h4>

              <div class="container-fluid">
                  <div class="row">
                      <div class="col-lg-4 col-md-6 col-sm-12 col-xs-12">
                        <div class="card mb-3">
                          <div class="card-body">
                            <h6  class="lead">${pollutant.co.display_name}: ${pollutant.co.full_name}</h6>
                            <h6><small class="badge badge-pill badge-info">Score: ${pollutant.co.aqi_information.baqi.aqi}</small></h6>
                            <h6><small class="badge badge-pill badge-info">Result: ${pollutant.co.aqi_information.baqi.category}</small></h6>
                            <small><span class="text-danger">Sources and effects</span>:${pollutant.co.sources_and_effects.sources}. ${pollutant.co.sources_and_effects.effects} </small>
                          </div>
                        </div>
                      </div>
                      <div class="col-lg-4 col-md-6 col-sm-12 col-xs-12">
                        <div class="card mb-3">
                          <div class="card-body">
                            <h6  class="lead">${pollutant.no2.display_name}: ${pollutant.no2.full_name}</h6> 
                            <h6><small class="badge badge-pill badge-info">Score: ${pollutant.no2.aqi_information.baqi.aqi}</small></h6>
                            <h6><small class="badge badge-pill badge-info">Result: ${pollutant.no2.aqi_information.baqi.category}</small></h6>
                            <small><span class="text-danger">Sources and effects</span>:${pollutant.no2.sources_and_effects.sources}. ${pollutant.no2.sources_and_effects.effects}</small>
                          </div>
                        </div>
                      </div>
                      <div class="col-lg-4 col-md-6 col-sm-12 col-xs-12">
                        <div class="card mb-3">
                          <div class="card-body">
                            <h6 class="lead">${pollutant.o3.display_name}: ${pollutant.o3.full_name}</h6> 
                            <h6><small class="badge badge-pill badge-info">Score: ${pollutant.o3.aqi_information.baqi.aqi}</small></h6>
                            <h6><small class="badge badge-pill badge-info">Result: ${pollutant.o3.aqi_information.baqi.category}</small></h6>
                            <small><span class="text-danger">Sources and effects</span>:${pollutant.o3.sources_and_effects.sources}. ${pollutant.o3.sources_and_effects.effects}</small>
                          </div>
                        </div>
                      </div>
                      <div class="col-lg-4 col-md-6 col-sm-12 col-xs-12">
                        <div class="card mb-3">
                          <div class="card-body">
                            <h6  class="lead">${pollutant.pm10.display_name}: ${pollutant.pm10.full_name}</h6> 
                            <h6><small class="badge badge-pill badge-info">Score: ${pollutant.pm10.aqi_information.baqi.aqi}</small></h6>
                            <h6><small class="badge badge-pill badge-info">Result: ${pollutant.pm10.aqi_information.baqi.category}</small></h6>
                            <small><span class="text-danger">Sources and effects</span>:${pollutant.pm10.sources_and_effects.sources}. ${pollutant.pm10.sources_and_effects.effects}</small>
                          </div>
                        </div>
                      </div>
                      <div class="col-lg-4 col-md-6 col-sm-12 col-xs-12">
                        <div class="card mb-3">
                          <div class="card-body">
                            <h6 class="lead">${pollutant.pm25.display_name}: ${pollutant.pm25.full_name}</h6> 
                            <h6><small class="badge badge-pill badge-info">Score: ${pollutant.pm25.aqi_information.baqi.aqi}</small></h6>
                            <h6><small class="badge badge-pill badge-info">Result: ${pollutant.pm25.aqi_information.baqi.category}</small></h6>
                            <small><span class="text-danger">Sources and effects</span>:${pollutant.pm25.sources_and_effects.sources}. ${pollutant.pm25.sources_and_effects.effects}</small>
                          </div>
                        </div>
                      </div>
                      <div class="col-lg-4 col-md-6 col-sm-12 col-xs-12">
                        <div class="card mb-3">
                          <div class="card-body">
                            <h6 class="lead">${pollutant.so2.display_name}: ${pollutant.so2.full_name}</h6> 
                            <h6><small class="badge badge-pill badge-info">Score: ${pollutant.so2.aqi_information.baqi.aqi}</small></h6>
                            <h6><small class="badge badge-pill badge-info">Result: ${pollutant.so2.aqi_information.baqi.category}</small></h6>
                            <small><span class="text-danger">Sources and effects</span>:${pollutant.so2.sources_and_effects.sources}. ${pollutant.so2.sources_and_effects.effects}</small>
                          </div>
                        </div>
                      </div>
                  </div>
              </div>
              `
            })
            .catch((error)=>{
              console.log(error)
              airQualityOutput2.innerHTML = `<h5 class="text-danger">Air Quality not available for this area</h5>`

            })
                
      }





      //- CODE FOR BREEZOMETER AIR QUALITY//
>>>>>>> Stashed changes
          // endOdTopNav
          // Traversy Google Geocode API & JavaScript Tutorial - for getting lat-long
          // END OF MODAL
          // JQUERY CDN
    script(src='https://code.jquery.com/jquery-3.4.1.slim.min.js', integrity='sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8=', crossorigin='anonymous')
